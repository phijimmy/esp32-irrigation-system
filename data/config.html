<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Config</title>
    <link rel="stylesheet" href="style.css">
    <style>
    /* Schedule card and table tweaks for better mobile alignment */
    #schedule-card {
        padding: 6px 4px 8px 4px !important;
    }
    #schedule-table th, #schedule-table td {
        padding: 0.5em 1px 0.5em 1px;
        font-size: 0.95em;
    }
    #schedule-table th.day-col, #schedule-table td.day-col {
        width: 18%;
        min-width: 60px;
        max-width: 80px;
        white-space: nowrap;
    }
    #schedule-table th.active-col, #schedule-table td.active-col {
        width: 12%;
        min-width: 40px;
        max-width: 60px;
        text-align: center;
    }
    #schedule-table th.start-col, #schedule-table th.stop-col,
    #schedule-table td.start-col, #schedule-table td.stop-col {
        width: 35%;
        min-width: 80px;
        max-width: 120px;
    }
    #schedule-table select {
        min-width: 2.5em;
        font-size: 1em;
        margin: 0 1px;
    }
    @media (max-width: 600px) {
        #schedule-card {
            padding: 2px 1px 4px 1px !important;
        }
        #schedule-table th, #schedule-table td {
            padding: 0.3em 0.5px 0.3em 0.5px;
            font-size: 0.92em;
        }
        #schedule-table th.day-col, #schedule-table td.day-col {
            width: 16%;
            min-width: 48px;
            max-width: 60px;
        }
        #schedule-table th.active-col, #schedule-table td.active-col {
            width: 10%;
            min-width: 32px;
            max-width: 40px;
        }
        #schedule-table th.start-col, #schedule-table th.stop-col,
        #schedule-table td.start-col, #schedule-table td.stop-col {
            width: 37%;
            min-width: 60px;
            max-width: 90px;
        }
        #schedule-table select {
            min-width: 2em;
            font-size: 0.98em;
        }
    }
    </style>
    <script defer src="config.js"></script>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Configuration</h1>
            <nav>
                <a href="index.html">Home</a>
                <a href="sensors.html">Sensors</a>
                <a href="led.html">LED</a>
                <a href="relay.html">Relay</a>
                <a href="touch.html">Touch</a>
                <a href="irrigation.html">Irrigation</a>
                <a href="config.html" class="active">Config</a>
                <!-- Schedule link removed -->
            </nav>
            <p>System Configuration</p>
        </div>
        <form id="config-form">
        <div class="cards-grid">
            <!-- ...existing cards... -->
            <div class="card">
                <div class="card-header">
                    <div class="card-icon info-icon">üåê</div>
                    <div class="card-title">Network</div>
                </div>
                <div class="card-content">
                    <label for="network-mode">WiFi Mode:</label>
                    <select id="network-mode">
                        <option value="ap">Access Point</option>
                        <option value="client">Client</option>
                    </select>
                    <div id="wifi-client-fields" style="display:none; margin-top:1em;">
                        <label for="wifi-ssid">WiFi SSID:</label>
                        <input type="text" id="wifi-ssid" name="wifi-ssid" autocomplete="off"><br>
                        <label for="wifi-pass">WiFi Password:</label>
                        <input type="password" id="wifi-pass" name="wifi-pass" autocomplete="off"><br>
                    </div>
                    <div id="wifi-ap-fields" style="display:none; margin-top:1em;">
                        <label for="ap-ssid">AP SSID:</label>
                        <input type="text" id="ap-ssid" name="ap-ssid" autocomplete="off"><br>
                        <label for="ap-password">AP Password:</label>
                        <input type="password" id="ap-password" name="ap-password" autocomplete="off"><br>
                        <label for="ap-timeout">AP Timeout (seconds):</label>
                        <input type="number" id="ap-timeout" name="ap-timeout" min="0"><br>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <div class="card-icon info-icon">üå´Ô∏è</div>
                    <div class="card-title">Air Quality (MQ135)</div>
                </div>
                <div class="card-content">
                    <label for="mq135-warmup-time">Warmup Time (sec):</label>
                    <input type="number" id="mq135-warmup-time" name="mq135-warmup-time" min="10" max="600" step="1"><br>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <div class="card-icon info-icon">üí°</div>
                    <div class="card-title">LED</div>
                </div>
                <div class="card-content">
                    <label for="led-gpio">LED GPIO:</label>
                    <input type="number" id="led-gpio" name="led-gpio" min="0" max="39"><br>
                    <label for="led-blink-rate">Blink Rate (ms):</label>
                    <input type="number" id="led-blink-rate" name="led-blink-rate" min="10" max="10000"><br>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <div class="card-icon info-icon">üñ≤Ô∏è</div>
                    <div class="card-title">Touch</div>
                </div>
                <div class="card-content">
                    <label for="touch-gpio">Touch GPIO:</label>
                    <input type="number" id="touch-gpio" name="touch-gpio" min="0" max="39"><br>
                    <label for="touch-long-press">Long Press (ms):</label>
                    <input type="number" id="touch-long-press" name="touch-long-press" min="100" max="20000"><br>
                    <label for="touch-threshold">Touch Threshold:</label>
                    <input type="number" id="touch-threshold" name="touch-threshold" min="0" max="100"><br>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <div class="card-icon info-icon">üíß</div>
                    <div class="card-title">Soil Moisture</div>
                </div>
                <div class="card-content">
                    <label for="soil-moisture-wet">Wet Value:</label>
                    <input type="number" id="soil-moisture-wet" name="soil-moisture-wet"><br>
                    <label for="soil-moisture-dry">Dry Value:</label>
                    <input type="number" id="soil-moisture-dry" name="soil-moisture-dry"><br>
                    <label for="soil-power-gpio">Power GPIO:</label>
                    <input type="number" id="soil-power-gpio" name="soil-power-gpio" min="0" max="39"><br>
                    <label for="soil-stabilisation-time">Stabilisation Time (sec):</label>
                    <input type="number" id="soil-stabilisation-time" name="soil-stabilisation-time" min="1" max="120" step="1"><br>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <div class="card-icon info-icon">üöø</div>
                    <div class="card-title">Irrigation</div>
                </div>
                <div class="card-content">
                    <label for="watering-threshold">Watering Threshold (%):</label>
                    <input type="number" id="watering-threshold" name="watering-threshold" min="0" max="100"><br>
                    <label for="watering-duration">Watering Duration (sec):</label>
                    <input type="number" id="watering-duration" name="watering-duration" min="1" max="3600"><br>
                    <label for="irrigation-scheduled-hour">Scheduled Time:</label>
                    <select id="irrigation-scheduled-hour" name="irrigation-scheduled-hour"></select>
                    :
                    <select id="irrigation-scheduled-minute" name="irrigation-scheduled-minute"></select><br>
                </div>
            </div>



            <div class="card">
                <div class="card-header">
                    <div class="card-icon info-icon">‚öôÔ∏è</div>
                    <div class="card-title">System</div>
                </div>
                <div class="card-content">
                    <label for="device-name">Device Name:</label>
                    <input type="text" id="device-name" name="device-name"><br>
                    <label for="cpu-speed">CPU Speed (MHz):</label>
                    <input type="number" id="cpu-speed" name="cpu-speed" min="80" max="240"><br>
                    <label for="brownout-threshold">Brownout Threshold (V):</label>
                    <input type="number" id="brownout-threshold" name="brownout-threshold" min="1.5" max="3.5" step="0.1"><br>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <div class="card-icon info-icon">‚è∞</div>
                    <div class="card-title">Time / NTP</div>
                </div>
                <div class="card-content">
                    <label for="ntp-server-1">NTP Server 1:</label>
                    <input type="text" id="ntp-server-1" name="ntp-server-1"><br>
                    <label for="ntp-server-2">NTP Server 2:</label>
                    <input type="text" id="ntp-server-2" name="ntp-server-2"><br>
                    <label for="ntp-enabled">NTP Enabled:</label>
                    <input type="checkbox" id="ntp-enabled" name="ntp-enabled"><br>
                    <label for="ntp-sync-interval">NTP Sync Interval (s):</label>
                    <input type="number" id="ntp-sync-interval" name="ntp-sync-interval" min="60" max="86400"><br>
                    <label for="ntp-timeout">NTP Timeout (ms):</label>
                    <input type="number" id="ntp-timeout" name="ntp-timeout" min="100" max="60000"><br>

                    <hr style="margin:1em 0;">
                    <div id="device-time-section">
                        <div style="margin-bottom:0.5em; font-weight:bold;">Set Device Time:</div>
                        <div style="margin-bottom:0.5em; white-space:nowrap;">
                            <select id="manual-year" style="width:5em; font-size:1em;"></select>
                            -
                            <select id="manual-month" style="width:3.5em; font-size:1em;"></select>
                            -
                            <select id="manual-day" style="width:3.5em; font-size:1em;"></select>
                        </div>
                        <div style="margin-bottom:0.5em; white-space:nowrap;">
                            <select id="manual-hour" style="width:3.5em; font-size:1em;"></select>
                            :
                            <select id="manual-minute" style="width:3.5em; font-size:1em;"></select>
                            :
                            <select id="manual-second" style="width:3.5em; font-size:1em;"></select>
                        </div>
                        <button type="button" id="sync-browser-time-btn">Sync to Browser</button>
                        <button type="button" id="set-device-time-btn" style="margin-left:1em;">Set Time</button>
                        <div id="set-time-status" style="margin-top:0.5em; color:#2980b9;"></div>
                    </div>
                </div>
            </div>
            <div class="card">
                <div class="card-header">
                    <div class="card-icon info-icon">üîå</div>
                    <div class="card-title">Relays</div>
                </div>
                <div class="card-content" id="relays-config-fields">
                    <!-- Relay config fields and INT/SQW GPIO info will be rendered here by JS -->
                </div>
            </div>
            <div class="card" id="schedule-card">
                <div class="card-header">
                    <div class="card-icon time-icon">‚è≤Ô∏è</div>
                    <div class="card-title">Schedule</div>
                </div>
                <div class="card-content" id="schedule-content">
                    <div id="schedule-loading" class="loading">Loading schedule...</div>
                    <table id="schedule-table" style="width:100%;margin-top:1em;text-align:center;">
                        <thead>
                            <tr>
                                <th class="day-col">Day</th>
                                <th class="active-col">Active</th>
                                <th class="start-col">Start</th>
                                <th class="stop-col">Stop</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td class="day-col">Sun</td>
                                <td class="active-col"><input type="checkbox" class="sched-enabled" data-day="sunday"></td>
                                <td class="start-col">
                                    <select class="sched-hour" data-day="sunday" data-alarm="1"></select>:<select class="sched-minute" data-day="sunday" data-alarm="1"></select>
                                </td>
                                <td class="stop-col">
                                    <select class="sched-hour" data-day="sunday" data-alarm="2"></select>:<select class="sched-minute" data-day="sunday" data-alarm="2"></select>
                                </td>
                            </tr>
                            <tr>
                                <td class="day-col">Mon</td>
                                <td class="active-col"><input type="checkbox" class="sched-enabled" data-day="monday"></td>
                                <td class="start-col">
                                    <select class="sched-hour" data-day="monday" data-alarm="1"></select>:<select class="sched-minute" data-day="monday" data-alarm="1"></select>
                                </td>
                                <td class="stop-col">
                                    <select class="sched-hour" data-day="monday" data-alarm="2"></select>:<select class="sched-minute" data-day="monday" data-alarm="2"></select>
                                </td>
                            </tr>
                            <tr>
                                <td class="day-col">Tue</td>
                                <td class="active-col"><input type="checkbox" class="sched-enabled" data-day="tuesday"></td>
                                <td class="start-col">
                                    <select class="sched-hour" data-day="tuesday" data-alarm="1"></select>:<select class="sched-minute" data-day="tuesday" data-alarm="1"></select>
                                </td>
                                <td class="stop-col">
                                    <select class="sched-hour" data-day="tuesday" data-alarm="2"></select>:<select class="sched-minute" data-day="tuesday" data-alarm="2"></select>
                                </td>
                            </tr>
                            <tr>
                                <td class="day-col">Wed</td>
                                <td class="active-col"><input type="checkbox" class="sched-enabled" data-day="wednesday"></td>
                                <td class="start-col">
                                    <select class="sched-hour" data-day="wednesday" data-alarm="1"></select>:<select class="sched-minute" data-day="wednesday" data-alarm="1"></select>
                                </td>
                                <td class="stop-col">
                                    <select class="sched-hour" data-day="wednesday" data-alarm="2"></select>:<select class="sched-minute" data-day="wednesday" data-alarm="2"></select>
                                </td>
                            </tr>
                            <tr>
                                <td class="day-col">Thu</td>
                                <td class="active-col"><input type="checkbox" class="sched-enabled" data-day="thursday"></td>
                                <td class="start-col">
                                    <select class="sched-hour" data-day="thursday" data-alarm="1"></select>:<select class="sched-minute" data-day="thursday" data-alarm="1"></select>
                                </td>
                                <td class="stop-col">
                                    <select class="sched-hour" data-day="thursday" data-alarm="2"></select>:<select class="sched-minute" data-day="thursday" data-alarm="2"></select>
                                </td>
                            </tr>
                            <tr>
                                <td class="day-col">Fri</td>
                                <td class="active-col"><input type="checkbox" class="sched-enabled" data-day="friday"></td>
                                <td class="start-col">
                                    <select class="sched-hour" data-day="friday" data-alarm="1"></select>:<select class="sched-minute" data-day="friday" data-alarm="1"></select>
                                </td>
                                <td class="stop-col">
                                    <select class="sched-hour" data-day="friday" data-alarm="2"></select>:<select class="sched-minute" data-day="friday" data-alarm="2"></select>
                                </td>
                            </tr>
                            <tr>
                                <td class="day-col">Sat</td>
                                <td class="active-col"><input type="checkbox" class="sched-enabled" data-day="saturday"></td>
                                <td class="start-col">
                                    <select class="sched-hour" data-day="saturday" data-alarm="1"></select>:<select class="sched-minute" data-day="saturday" data-alarm="1"></select>
                                </td>
                                <td class="stop-col">
                                    <select class="sched-hour" data-day="saturday" data-alarm="2"></select>:<select class="sched-minute" data-day="saturday" data-alarm="2"></select>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <div style="margin-top:2em; text-align:center;">
            <button type="submit" id="save-config-btn">Save</button>
            <button type="button" id="clear-config-btn" style="background:#e67e22;color:#fff;margin-left:1em;">Clear Config</button>
            <button type="button" id="restart-btn" style="background:#c0392b;color:#fff;margin-left:1em;">Restart</button>
            <div id="clear-config-status" style="margin-top:0.5em;color:#e67e22;"></div>
        </div>
        </form>
    </div>
</body>
</html>
